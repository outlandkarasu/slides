# コラッツ予想<br>について<br>相談<br>させてください

小学生でもわかる数学の未解決問題

---

## 自己紹介

* からす
* 基本プログラマー
* 数学はほぼ素人……。
    * 10月に数学検定2級に挑戦します！
    * 高校数学2程度……。

**今日は、数学ガチ勢の皆さんから<br>アドバイスを頂くために来ました！**

---

## コラッツ予想とは

任意の自然数(0を除く)について、

- 偶数なら、2で割る。
- 奇数なら、3倍して1を足す。

---

これを繰り返すと、

**必ずいつか1になる**

という予想です。

---

### 数式

`\[
f(n) = \left\{
\begin{array}{ll}
n / 2 & (n \bmod 2 \equiv 0) \\
3n + 1 & (n \bmod 2 \equiv 1) \\
\end{array}
\right.
\]`

---

### 例

- 5 → 16 → 8 → 4 → 2 → 1
- 11 → 34 → 17 → 52 → 26 → 13 → 40 → 20 → 10 → 5 → 16 → 8 → 4 → 2 → 1

---

### 長い例(27)

27→82→41→124→62→31→94→47→142→71→214→107→322→161→484→242→121→<br>
364→182→91→274→137→412→206→103→310→155→466→233→700→350→175→<br>
526→263→790→395→1186→593→1780→890→445→1336→668→334→167→502→<br>
251→754→377→1132→566→283→850→425→1276→638→319→958→479→1438→<br>
719→2158→1079→3238→1619→4858→2429→7288→3644→1822→911→2734→<br>
1367→4102→2051→6154→3077→9232→4616→2308→1154→577→1732→866→<br>
433→1300→650→325→976→488→244→122→61→184→92→46→23→70→35→106→<br>
53→160→80→40→20→10→5→16→8→4→2→1

---

## プログラマー的な見方

3n + 1 を分解すると、ビットシフトと加算で表現できる。

- 3n + 1 = (2n + n) + 1

```d
n = n << 1 + n + 1;
```

---

### ビットで見る

4の場合

-   101
-  1111 (3倍)
- 10000 (足す1)
-     1 (2で割る × 4回)

---

## 見える化

昔まとめました。

https://www.slideshare.net/AkiraYamaguchi6/ss-61066884

---

## 考察

- 3^n によりビット列は伸びる。
- +1により最下位ビットから連続するビットは消える。
- **このせめぎ合いでビットが消え、最終的に1だけになる。**

---

## 伸び方・減り方

3nで伸びる量は下記の通りで、約1.58

`\[
\log_2 3^n = n \log_2 3
\]`

一方、**+1で減る量は実験したところ約2。**

---

## 行き詰まり

- 3nで増えるビット数 < +1で減るビット数
- しかし、**なぜ+1で平均2減るのかが明らかでない。**
- もし、巨大な数でビットの密度が2を超える場合があったら、コラッツ予想は反証される。
- あるタイミングでだけビット密度が高い場合も、<br>巧妙に初期値を選ぶことで無限ループを発生させられるかもしれない。

---

## 逆から見る

- 5 → 16 → 8 → 4 → 2 → 1
- 5 ←  16 ←  8←  4 ←  2 ←  1

---

1からスタートして、以下の処理を繰り返すことで<br>
**任意の自然数に辿り着ける。**

- 2倍する。
- 1引いた数が3で割り切れて、かつ割った後の数が偶数の場合
    - 1を引いて3で割る。

---

## 木を生やす

ホワイトボードに書きます。

---

## 式にしてみる

`\[
1 \\
1 \cdot 2^a \\
3^{-1}(1 \cdot 2^a - 1) \\
2^b3^{-1}(1 \cdot 2^a - 1) \\
3^{-1}\{2^b3^{-1}(1 \cdot 2^a - 1) - 1\} \\
2^c3^{-1}\{2^b3^{-1}(1 \cdot 2^a - 1) - 1\} \\
\]`

---

## 式変形してみる

`\[
\begin{align}
&2^c3^{-1}\{2^b3^{-1}(1 \cdot 2^a - 1) - 1\} \\
&2^{b+c}3^{-2}(1 \cdot 2^a - 1) - 2^c3^{-1} &(2^c3^{-1}を分配)\\
&2^{a+b+c}3^{-2} - 2^{b+c}3^{-2} - 2^c3^{-1} \\
&&(2^{b+c}3^{-2}を分配)\\
&3^{-2}(2^{a+b+c} - 2^{b+c} - 2^c3^1) &(全体を3^{-2}で割る)
\end{align}
\]`

---

`\[
\begin{align}
x = 3^{-2}(2^{a+b+c} - 2^{b+c} - 2^c3^1) \\
3^2x = 2^{a+b+c} - 2^{b+c} - 2^c3^1 &(両辺を3^2する)\\
2^{b+c} + 2^c3^1 + 3^2x = 2^{a+b+c} \quad (移項)
\end{align}
\]`

---

## ディオファントス方程式?

`\[
2^{b+c} + 2^c3^1 + 3^2x = 2^{a+b+c}
2^{b+c+d} + 2^{c+d}3^1 + 2^d3^2 + 3^3x = 2^{a+b+c+d}
2^{b+c+d+e} + 2^{c+d+e}3^1 + 2^{d+e}3^2 + 2^{e}3^3 + 3^4x = 2^{a+b+c+d+e}
\]`

**コラッツ予想が成り立つ場合、上の形の式には全て整数解がある!**

---

## 行き詰まり

- ディオファントス方程式は人類にはまだ早すぎるみたい……。
    - e.g. フェルマーの最終定理
    - x^3 + y^3 + z^3 - 3 = 0 ですら整数解がいくつあるかわからない?

---

## これから

- 普通に見た場合
    - log2 3 のビット列の密度を調べる?
- 逆に見た場合
    - ディオファントス方程式の解き方などについて調べる?

---

## 未解決問題楽しい！

- 正解はまだない = 何でもアリ
- 解けなくても**恥ずかしくない！**
- 暇を持て余しているアマチュアこそ挑戦するべきかも。

